---
source: crates/shinier_rb_formatter/tests/snapshot_test.rs
assertion_line: 225
expression: output
input_file: crates/shinier_rb_formatter/tests/ruby/node_variants/back_reference_read_node.rb
---
****FORMATTED****
# Basic back references
$&
$`
$'
$+

# Numbered back references
$1
$2
$10
$99

# Match data
$~

# In expressions
'hello'.=~(/(\w+)/)
puts($1)
result = $&.+($')

# In string interpolation
"matched: #{$1}"
"before: #{$`}, after: #{$'}"

# In conditionals
if $1
  puts($&)
end

# In method calls
process($1, $2)
array = [$1, $2, $3]

# Complex expressions
value = $1 || 'default'
combined = "#{$`}[#{$&}]#{$'}"

# In blocks
%w[a b].each{ |item|
  item.=~(/(\w)/)
  puts($1)
}

# Multiple references in one line
"#{$1} and #{$2} and #{$3}"

# With method chains
$1.upcase.strip
$&.length

# In array/hash literals
{ match: $&, before: $`, after: $' }
[$1, $2, $3].compact


****AST****
ProgramNode[24-668]: "$&\n$`\n$\'\n$+\n\n# Numbered back references\n$1\n$2\n$10\n$99\n\n# Match data\n$~\n\n# In expressions\n\"hello\" =~ /(\\w+)/\nputs $1\nresult = $& + $\'\n\n# In string interpolation\n\"matched: #{$1}\"\n\"before: #{$`}, after: #{$\'}\"\n\n# In conditionals\nif $1\n  puts $&\nend\n\n# In method calls\nprocess($1, $2)\narray = [$1, $2, $3]\n\n# Complex expressions\nvalue = $1 || \"default\"\ncombined = \"#{$`}[#{$&}]#{$\'}\"\n\n# In blocks\n[\'a\', \'b\'].each do |item|\n  item =~ /(\\w)/\n  puts $1\nend\n\n# Multiple references in one line\n\"#{$1} and #{$2} and #{$3}\"\n\n# With method chains\n$1.upcase.strip\n$&.length\n\n# In array/hash literals\n{ match: $&, before: $`, after: $\' }\n[$1, $2, $3].compact"
__BackReferenceReadNode[24-26]: "$&"
__BackReferenceReadNode[27-29]: "$`"
__BackReferenceReadNode[30-32]: "$\'"
__BackReferenceReadNode[33-35]: "$+"
__NumberedReferenceReadNode[64-66]: "$1"
__NumberedReferenceReadNode[67-69]: "$2"
__NumberedReferenceReadNode[70-73]: "$10"
__NumberedReferenceReadNode[74-77]: "$99"
__GlobalVariableReadNode[92-94]: "$~"
__CallNode[113-131]: "\"hello\" =~ /(\\w+)/"
____StringNode[113-120]: "\"hello\""
____RegularExpressionNode[124-131]: "/(\\w+)/"
__CallNode[132-139]: "puts $1"
____NumberedReferenceReadNode[137-139]: "$1"
__LocalVariableWriteNode[140-156]: "result = $& + $\'"
____CallNode[149-156]: "$& + $\'"
______BackReferenceReadNode[149-151]: "$&"
______BackReferenceReadNode[154-156]: "$\'"
__InterpolatedStringNode[184-200]: "\"matched: #{$1}\""
____StringNode[185-194]: "matched: "
____EmbeddedStatementsNode[194-199]: "#{$1}"
______NumberedReferenceReadNode[196-198]: "$1"
__InterpolatedStringNode[201-230]: "\"before: #{$`}, after: #{$\'}\""
____StringNode[202-210]: "before: "
____EmbeddedStatementsNode[210-215]: "#{$`}"
______BackReferenceReadNode[212-214]: "$`"
____StringNode[215-224]: ", after: "
____EmbeddedStatementsNode[224-229]: "#{$\'}"
______BackReferenceReadNode[226-228]: "$\'"
__IfNode[250-269]: "if $1\n  puts $&\nend"
____NumberedReferenceReadNode[253-255]: "$1"
____CallNode[258-265]: "puts $&"
______BackReferenceReadNode[263-265]: "$&"
__CallNode[289-304]: "process($1, $2)"
____NumberedReferenceReadNode[297-299]: "$1"
____NumberedReferenceReadNode[301-303]: "$2"
__LocalVariableWriteNode[305-325]: "array = [$1, $2, $3]"
____ArrayNode[313-325]: "[$1, $2, $3]"
______NumberedReferenceReadNode[314-316]: "$1"
______NumberedReferenceReadNode[318-320]: "$2"
______NumberedReferenceReadNode[322-324]: "$3"
__LocalVariableWriteNode[349-372]: "value = $1 || \"default\""
____OrNode[357-372]: "$1 || \"default\""
______NumberedReferenceReadNode[357-359]: "$1"
______StringNode[363-372]: "\"default\""
__LocalVariableWriteNode[373-403]: "combined = \"#{$`}[#{$&}]#{$\'}\""
____InterpolatedStringNode[384-403]: "\"#{$`}[#{$&}]#{$\'}\""
______EmbeddedStatementsNode[385-390]: "#{$`}"
________BackReferenceReadNode[387-389]: "$`"
______StringNode[390-391]: "["
______EmbeddedStatementsNode[391-396]: "#{$&}"
________BackReferenceReadNode[393-395]: "$&"
______StringNode[396-397]: "]"
______EmbeddedStatementsNode[397-402]: "#{$\'}"
________BackReferenceReadNode[399-401]: "$\'"
__CallNode[417-473]: "[\'a\', \'b\'].each do |item|\n  item =~ /(\\w)/\n  puts $1\nend"
____ArrayNode[417-427]: "[\'a\', \'b\']"
______StringNode[418-421]: "\'a\'"
______StringNode[423-426]: "\'b\'"
____BlockNode[433-473]: "do |item|\n  item =~ /(\\w)/\n  puts $1\nend"
______BlockParametersNode[436-442]: "|item|"
________RequiredParameterNode[437-441]: "item"
______StatementsNode[445-469]: "item =~ /(\\w)/\n  puts $1"
________CallNode[445-459]: "item =~ /(\\w)/"
__________LocalVariableReadNode[445-449]: "item"
__________RegularExpressionNode[453-459]: "/(\\w)/"
________CallNode[462-469]: "puts $1"
__________NumberedReferenceReadNode[467-469]: "$1"
__InterpolatedStringNode[509-536]: "\"#{$1} and #{$2} and #{$3}\""
____EmbeddedStatementsNode[510-515]: "#{$1}"
______NumberedReferenceReadNode[512-514]: "$1"
____StringNode[515-520]: " and "
____EmbeddedStatementsNode[520-525]: "#{$2}"
______NumberedReferenceReadNode[522-524]: "$2"
____StringNode[525-530]: " and "
____EmbeddedStatementsNode[530-535]: "#{$3}"
______NumberedReferenceReadNode[532-534]: "$3"
__CallNode[559-574]: "$1.upcase.strip"
____CallNode[559-568]: "$1.upcase"
______NumberedReferenceReadNode[559-561]: "$1"
__CallNode[575-584]: "$&.length"
____BackReferenceReadNode[575-577]: "$&"
__HashNode[611-647]: "{ match: $&, before: $`, after: $\' }"
____AssocNode[613-622]: "match: $&"
______SymbolNode[613-619]: "match:"
______BackReferenceReadNode[620-622]: "$&"
____AssocNode[624-634]: "before: $`"
______SymbolNode[624-631]: "before:"
______BackReferenceReadNode[632-634]: "$`"
____AssocNode[636-645]: "after: $\'"
______SymbolNode[636-642]: "after:"
______BackReferenceReadNode[643-645]: "$\'"
__CallNode[648-668]: "[$1, $2, $3].compact"
____ArrayNode[648-660]: "[$1, $2, $3]"
______NumberedReferenceReadNode[649-651]: "$1"
______NumberedReferenceReadNode[653-655]: "$2"
______NumberedReferenceReadNode[657-659]: "$3"
